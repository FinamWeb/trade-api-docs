---
sidebar_position: 5
---

# Использование

Описание всех текущих методов API и параметров их вызова доступно по адресу https://trade-api.comon.ru/swagger/index.html. Здесь же можно выполнить запросы по токену прямо в браузере.

Все методы можно разделить на группы. Далее идет описание групп и их основных методов

## Авторизация

Для выполнения методов api необходимо передавать токен доступа в каждом запросе.

Формат заголовка: `Authorization: Bearer <токен_доступ>`

## Рыночная информация

Сюда относятся методы получения текущей рыночной информации:

- Получение информации о доступных инструментах и их параметрах `GET ​/api​/v1​/securities`
- Получение информации об истории торгов по инструменту (график)
- Получение потоковой информации maret data. Реализовано в виде методов подписки на события. Можно подписываться на следующие события:
  - Стакан
  - Котировки
  - Сделки

## Клиентский счет

Trade-api позволяет получить доступ только к Единым счетам, открытым в АО "Финам". Оперирование идет по торговому коду, который вы видите в ИТС TRANSAQ. Торговый код необходимо использовать в поле `ClientID`.

Сюда относятся методы:

- Получения текущего состояния счета `GET ​/api​/v1​/portfolio`
- Получение информации о заявках `GET ​/api​/v1​/orders` или стоп-заявках `GET ​/api​/v1​/stop-orders` по счетам
- Получение информации о сделках по счетам

## Торговые операции

Сюда относятся методы:

- Выставить новую заявку (рыночную / лимитированную условную) по счету `POST ​/api​/v1​/orders`
- Отменить заявку `DELETE ​/api​/v1​/orders` или стоп-заявку `DELETE ​/api​/v1​/stop-orders`

На обработку нового поручения по размещению заявки в биржевой стакан требуется некоторое время, поэтому этот метод возвращает структуру с `transaction_id`, которая может быть использована для поиска соответствующей заявки через `GetOrdersRequest` или в сообщении `OrderEvent` от сервиса событий (`EventResponse.event.order`)

:::info Справка

`transaction_id` - это целочисленный номер, который однозначно идентифицирует транзакцию внутри текущего сеанса связи с сервером.

:::

После того, как в результате транзакции на Бирже появится соответствующий объект (заявка), основным идентификатором этого объекта становится регистрационный номер Биржи. Transactionid является также основным идентификатором условной заявки, являющейся результатом транзакции, до тех пор, пока заявка не будет выставлена на Биржу и приобретёт регистрационный номер Биржи.

Значения property:

- **PutInQueue**: неисполненная часть заявки помещается в очередь заявок Биржи
- **FOK**: сделки совершаются только в том случае, если заявка может быть удовлетворена полностью
- **IOC**: неисполненная часть заявки снимается с торгов
- Для выставления рыночной заявки достаточно указать в поле `price` значение **0**.

Допустимые типы условия условных заявок:

- **Bid**: лучшая цена покупки
- **BidOrLast**: лучшая цена покупки или сделка по заданной цене и выше
- **Ask**: лучшая цена продажи
- **AskOrLast**: лучшая цена продажи или сделка по заданной цене и ниже
- **CovDown**: обеспеченность ниже заданной
- **CovUp**: обеспеченность выше заданной
- **LastUp**: сделка на рынке по заданной цене или выше
- **LastDown**: сделка на рынке по заданной цене или ниже

Такие поля как, например, `condition` или `validbefore` являются необязательными. Их можно не указывать в запросе

Для отмены заявки нужно также указать `transaction_id`.
